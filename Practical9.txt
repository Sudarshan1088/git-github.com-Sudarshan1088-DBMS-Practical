import java.sql.*; 
import java.util.Scanner; 
public class LibraryDB { 
    public static void main(String[] args) { 
        String url = "jdbc:mysql://localhost:3306/testdb"; // your DB 
        String user = "root";  // your MySQL username 
        String password = "root"; // your MySQL password 
 
        Scanner sc = new Scanner(System.in); 
 
        try { 
            // Load Driver 
            Class.forName("com.mysql.cj.jdbc.Driver"); 
 
            // Establish Connection 
            Connection con = DriverManager.getConnection(url, user, password); 
            System.out.println("Database Connected Successfully!"); 
 
            while (true) { 
                System.out.println("\n--- MENU ---"); 
                System.out.println("1. Add Record"); 
                System.out.println("2. View Records"); 
                System.out.println("3. Update Record"); 
                System.out.println("4. Delete Record"); 
                System.out.println("5. Exit"); 
                System.out.print("Enter choice: "); 
                int choice = sc.nextInt(); 
                sc.nextLine(); 
 
                switch (choice) { 
                    case 1: // Add 
                        System.out.print("Enter Title: "); 
                        String title = sc.nextLine(); 
                        System.out.print("Enter Author: "); 
                        String author = sc.nextLine(); 
                        System.out.print("Enter Price: "); 
                        double price = sc.nextDouble(); 
 
                        PreparedStatement ps = con.prepareStatement( 
                            "INSERT INTO Library (Title, Author, Price) VALUES (?, ?, ?)"); 
                        ps.setString(1, title); 
                        ps.setString(2, author); 
                        ps.setDouble(3, price); 
                        ps.executeUpdate(); 
                        System.out.println("Record Added Successfully!"); 
                        break; 
 
                    case 2: // View 
                        Statement st = con.createStatement(); 
                        ResultSet rs = st.executeQuery("SELECT * FROM Library"); 
                        while (rs.next()) { 
                            System.out.println(rs.getInt(1) + " | " + 
                                               rs.getString(2) + " | " + 
                                               rs.getString(3) + " | " + 
                                               rs.getDouble(4)); 
                        } 
                        break; 
 
                    case 3: // Update 
                        System.out.print("Enter BookID to Update: "); 
                        int bid = sc.nextInt(); 
                        sc.nextLine(); 
                        System.out.print("Enter New Title: "); 
                        String newTitle = sc.nextLine(); 
                        PreparedStatement ps2 = con.prepareStatement( 
                            "UPDATE Library SET Title=? WHERE BookID=?"); 
                        ps2.setString(1, newTitle); 
                        ps2.setInt(2, bid); 
                        ps2.executeUpdate(); 
                        System.out.println("Record Updated!"); 
                        break; 
 
                    case 4: // Delete 
                        System.out.print("Enter BookID to Delete: "); 
                        int delID = sc.nextInt(); 
                        PreparedStatement ps3 = con.prepareStatement( 
                            "DELETE FROM Library WHERE BookID=?"); 
                        ps3.setInt(1, delID); 
                        ps3.executeUpdate(); 
                        System.out.println("Record Deleted!"); 
                        break; 
 
                    case 5: // Exit 
                        con.close(); 
                        System.out.println("Disconnected from Database."); 
                        System.exit(0); 
                } 
            } 
        } catch (Exception e) { 
            e.printStackTrace(); 
        } 
    } 
}