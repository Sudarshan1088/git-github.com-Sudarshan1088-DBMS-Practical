-- 1. Create Database 
CREATE DATABASE IF NOT EXISTS StudentDB1; 
USE StudentDB1; 
-- 3. Create Old Roll Call Table 
CREATE TABLE O_RollCall ( 
RollNo INT PRIMARY KEY, 
Name VARCHAR(50) 
); 
-- 4. Create New Roll Call Table 
CREATE TABLE N_RollCall ( 
RollNo INT PRIMARY KEY, 
Name VARCHAR(50) 
); 
-- 5. Insert Sample Data 
INSERT INTO O_RollCall VALUES (101, 'Ketan'), (102, 'Ravi'), (103, 'Sneha'); 
INSERT INTO N_RollCall VALUES (102, 'Ravi');  -- Already exists in new table 
-- 6. Create Stored Procedure to Merge Data 
DELIMITER $$ 
CREATE PROCEDURE MergeRollCall() 
BEGIN 
    DECLARE done INT DEFAULT 0; 
    DECLARE v_RollNo INT; 
    DECLARE v_Name VARCHAR(50); 
 
    -- Declare cursor for old roll call 
    DECLARE cur_old CURSOR FOR 
        SELECT RollNo, Name FROM O_RollCall; 
 
    -- Handler for end of cursor 
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1; 
 
    -- Open cursor 
    OPEN cur_old; 
 
    read_loop: LOOP 
        FETCH cur_old INTO v_RollNo, v_Name; 
        IF done = 1 THEN 
            LEAVE read_loop; 
        END IF; 
 
        -- Insert only if not exists 
        IF NOT EXISTS (SELECT 1 FROM N_RollCall WHERE RollNo = v_RollNo) THEN 
            INSERT INTO N_RollCall(RollNo, Name) VALUES (v_RollNo, v_Name); 
        END IF; 
 
END LOOP; 
CLOSE cur_old; 
END$$ 
DELIMITER ; 
-- 7. Call Procedure to Merge Data 
CALL MergeRollCall(); 
-- 8. Check Result 
SELECT * FROM N_RollCall ORDER BY RollNo;